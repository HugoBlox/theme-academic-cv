---
# Documentation: https://wowchemy.com/docs/managing-content/

title: "正規表現" # 記事タイトル
subtitle: "" # 記事のサブタイトル(省略可)
summary: "ちょっと使えるかもしれない概念について" # 要約：記事の中身を端的に表す短い文章
authors: [yamamayumi9489] # 著者ID(複数可)
tags: [] # タグ：記事内容のジャンルなどを表す単語(複数可)
categories: []
date: 2022-09-20T20:00:00+09:00
featured: false
draft: false

# Featured image
# To use, add an image named `featured.jpg/png` to your page's folder.
# Focal points: Smart, Center, TopLeft, Top, TopRight, Left, Right, BottomLeft, Bottom, BottomRight.
image:
  caption: ""
  focal_point: ""
  preview_only: false

# Projects (optional).
#   Associate this post with one or more of your projects.
#   Simply enter your project's folder or file name without extension.
#   E.g. `projects = ["internal-project"]` references `content/project/deep-learning/index.md`.
#   Otherwise, set `projects = []`.
projects: []
---
# はじめに
　そこそこの分量のある文章を書いたとき、途中で「この漢字間違ってた！」とか「単位をmmじゃなくてcmにしていた！」となった経験はあるでしょうか。多少の修正ならばいいものの、修正箇所が多い場合、どこか分からない場合は非常に面倒なことになってしまいます。  
　そんな時に有用なのが「検索と置換」という機能です。特定の文章を別の文章に一括で置き換えることができます。しかし、「約○○m」のように値を保持したまま前後に文章を追加するとなると一筋縄ではいきません。また、意図しない変更が起きてしまうのも避けたいところです。

{{<figure src="./regexp_mistake.jpg" title="意図しない変更が起きてしまう例">}}

　このような問題は、「正規表現」と呼ばれるものを用いることで解決できるかもしれません。

# 正規表現とは
　特定の条件を満たす文字列の集合を、１つの形式で表現する方法です。例えば `\d{4}/\d{2}/\d{2}` と書くと `2022/09/20` や `1999/10/23` のように日付を表す文字列の集合を表しますし、`[a-z]{5}` と書くと `extra` や `abcde` のような５文字の小文字アルファベットを表します。

---

## メタ文字
　正規表現では、 `.()[]{}/\*+-|?` 等の**メタ文字**と呼ばれるものは特殊な意味を持ちます。また、メタ文字は組み合わせて複雑な正規表現を表すことができます。以下は主なメタ文字と正規表現の例です。

#### . （ドット）
改行を除く任意の１文字を表します。  
`あ.こ` は `あいこ` `あいす` `あXこ` 等が当てはまります。
#### + （プラス）
直前の文字が１文字以上続くことを表します。  
`go+gle` は `gogle` `google` `goooooogle` 等が当てはまります。
#### * （アスタリスク）
直前の文字が**0文字**以上続くことを表します。  
`かた*き` は `かき` `かたき` `かたたたき` 等が当てはまります。
#### ? （クエスチョンマーク）
直前の文字が0文字か1文字あることを表します。  
`100億?円` は `100円` と `100億円` が当てはまります。
#### () （丸括弧）
複数文字の表現をグループ化することができます。  
`(ひい)*おじいちゃん` は `おじいちゃん` `ひいひいおじいちゃん` 等が当てはまります。
#### | （パイプ）
複数表現のいずれかを表します。  
`good (morning|afternoon|night)` は `good morning` `good afternoon` `good night` が当てはまります。
#### [] （角括弧）
括弧内の文字のいずれかを表します。アルファベットやひらがな、数字などは `A-Z` 、 `a-z` 、 `か-こ` 、 `0-9` のように省略することもできます。  
`[aiueo]+` は `oue` `ai` のように母音だけで表される１文字以上の文字列が当てはまります。
#### {} （波括弧）
直前の文字が連続する回数を制限します。 `{n}` はn回、 `{n,m}` はn回以上m回以下繰り返すことを表します。  `[1-9][0-9]{5}` は `123456` `314159` のような６桁の数字を表します。

　なお、これらメタ文字自身を正規表現で表すときは `\` （バックスラッシュ）をメタ文字の前に付けて表します。

---

## エスケープシーケンス
　正規表現の中でバックスラッシュはメタ文字をただの文字として扱うために用いられますが、いくつかのアルファベットの前につけることで別の使い方をすることができます。以下はその数例です。

#### `\d`
`[0-9]` と同じ意味で、任意のアラビア数字１文字を表します。
#### `\w`
`[0-9a-zA-Z_]` と同じ意味で、アルファベット、アラビア数字、アンダースコア `_` のうち任意の１文字を表します。
#### `\R`
全ての改行コードのうちいずれかを表します。
#### `\s`
半角スペース、タブ、改行などの空白文字のうちいずれかを表します。
#### `\S`
`\s` で表されるもの以外の任意の文字を表します。同様に、 `\D` は数字以外、 `\W` はアルファベット、数字、アンダースコア以外の文字を表します。

---

## キャプチャと後方参照

　丸括弧を使うと正規表現のグループ化ができますが、正規表現に当てはまる文字列を見つけた際に括弧内の表現を保持することができます。

　例えば、この記事の最初のように４桁の標高「○○m」を「約○○M」と置換することを考えます。４桁の標高は `[1-9]\d{3}m` という正規表現で表されます。この数字部分を丸括弧に入れる、すなわち `([1-9]\d{3})m` という正規表現にすると、各標高の値を保持できます。  
　保持した表現を用いるには `$n` を用います（注：ものによって `\n` を用いることもあります。どちらを用いるかは使うもの毎に確認をお願いします）。ここで `n` は、正規表現にある何番目の括弧の表現を用いるかによって変わります。今回は括弧は１つしか使用していないため、置換後の文字列を表す正規表現は `約$1M` となります。実際にやってみましょう。

{{<figure src="./regexp_before.jpg" title="置換前">}}
{{<figure src="./regexp_after.jpg" title="置換後">}}

　無事、ローマ字表記を崩さずに標高の表記だけを変えることができました！

# まとめ
　正規表現を用いることで、面倒な置換作業を楽に行うことができます。今回紹介した正規表現以外にも便利な記法がたくさんあります。正規表現は置換作業の簡略化以外にも、パスワードや住所等を入力するフォームで入力形式が正しいか確認したりすることもできます。正規表現はとても奥が深いので、興味を持った方はぜひ調べてみることをお勧めします。
